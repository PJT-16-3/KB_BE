<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.scoula.mapper.ProbabilityMapper">

    <select id="selectScoreRecords" resultType="org.scoula.dto.ScoreRecord">
        SELECT
            min_score AS minScore,
            avg_score AS avgScore,
            max_score AS maxScore,
            supply_count AS supplyCount,
            resident_code AS residentCode
        FROM subscription_history
        WHERE sido = #{sido}
          AND sigungu = #{sigungu}
          AND resident_code = #{residentCode}
    </select>

    <select id="selectAptInfo" resultType="org.scoula.dto.AptInfo">
        SELECT
            sido,
            sigungu,
            resident_code AS residentCode,
            supply_count AS supplyCount
        FROM apt_table
        WHERE apt_idx = #{aptIdx}
    </select>
    <select id="getPythonAptInfoByPblancNo" resultType="org.scoula.dto.PythonAptRequestDTO">
        SELECT *
        FROM vw_apt_predict_input
        WHERE pblanc_no = #{pblancNo}
    </select>
    <select id="getPythonOfficetelInfoByPblancNo" resultType="org.scoula.dto.PythonOfficetelRequestDTO">
        SELECT
            o.si                              AS si,
            o.sigungu                         AS sigungu,
            o.tot_suply_hshldco               AS totSuplyHshldco,
            COALESCE(SUM(t.suply_hshldco), 0) AS suplyHshldco
        FROM officetel_table o
                 LEFT JOIN officetel_type t
                           ON o.officetel_idx = t.officetel_idx
        WHERE o.pblanc_no = #{pblancNo}
        GROUP BY o.si, o.sigungu, o.tot_suply_hshldco
    </select>


</mapper>
